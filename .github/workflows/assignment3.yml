name: assignment3
on: 
  push:
jobs:
    build:
      runs-on: ubuntu-latest
      steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: Build the image
        run: |
          docker build . --file Dockerfile --tag myapp:latest
      - name: updating the log file, if succesful image built
        if: success()
        run: |
          current_time=$(date -Iminutes)
          echo " $current_time" > log.txt
          echo "Sagi Vaknin and Rani Bezalel" >> log.txt
          echo "image successfully built" >> log.txt 
      - name: updating the log file, if failure in image build
        if: failure()
        run: |
          current_time=$(date -Iminutes)
          echo " $current_time" > log.txt
          echo "Sagi Vaknin and Rani Bezalel" >> log.txt
          echo "image not able to be built" >> log.txt 
      - name: upload the image
        if: success()
        uses: actions/upload-artifact@v3
        with:
          name: myimage
          path: myapp:latest
      - name: upload the log file into GitHub repo
        if: always()
        uses: actions/upload-artifact@v3
        with: 
          name: logfile
          path: log.txt

        

    #test:

    #query:
